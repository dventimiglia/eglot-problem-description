# -*- mode: org; -*-

#+STARTUP: indent

* Problem

* Checklist

1. Include the transcript of JSONRPC events obtained from the buffer
   popped up by M-x eglot-events-buffer. You may narrow down the
   transcript if you are sure of where the problematic exchange is,
   but it’s safer to include the whole transcript, either attached or
   inline.

   #+begin_src json
   [jsonrpc] D[05:56:11.451] Running language server: dart language-server --client-id emacs.eglot-dart
   [jsonrpc] e[05:56:11.451] --> initialize[1] {"jsonrpc":"2.0","id":1,"method":"initialize","params":{"processId":147340,"clientInfo":{"name":"Eglot","version":"1.17"},"rootPath":"/home/davidaventimiglia/Scratch/eglot-problem-description/","rootUri":"file:///home/davidaventimiglia/Scratch/eglot-problem-description","initializationOptions":{},"capabilities":{"workspace":{"applyEdit":true,"executeCommand":{"dynamicRegistration":false},"workspaceEdit":{"documentChanges":true},"didChangeWatchedFiles":{"dynamicRegistration":true},"symbol":{"dynamicRegistration":false},"configuration":true,"workspaceFolders":true},"textDocument":{"synchronization":{"dynamicRegistration":false,"willSave":true,"willSaveWaitUntil":true,"didSave":true},"completion":{"dynamicRegistration":false,"completionItem":{"snippetSupport":true,"deprecatedSupport":true,"resolveSupport":{"properties":["documentation","details","additionalTextEdits"]},"tagSupport":{"valueSet":[1]}},"contextSupport":true},"hover":{"dynamicRegistration":false,"contentFormat":["markdown","plaintext"]},"signatureHelp":{"dynamicRegistration":false,"signatureInformation":{"parameterInformation":{"labelOffsetSupport":true},"documentationFormat":["markdown","plaintext"],"activeParameterSupport":true}},"references":{"dynamicRegistration":false},"definition":{"dynamicRegistration":false,"linkSupport":true},"declaration":{"dynamicRegistration":false,"linkSupport":true},"implementation":{"dynamicRegistration":false,"linkSupport":true},"typeDefinition":{"dynamicRegistration":false,"linkSupport":true},"documentSymbol":{"dynamicRegistration":false,"hierarchicalDocumentSymbolSupport":true,"symbolKind":{"valueSet":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26]}},"documentHighlight":{"dynamicRegistration":false},"codeAction":{"dynamicRegistration":false,"resolveSupport":{"properties":["edit","command"]},"dataSupport":true,"codeActionLiteralSupport":{"codeActionKind":{"valueSet":["quickfix","refactor","refactor.extract","refactor.inline","refactor.rewrite","source","source.organizeImports"]}},"isPreferredSupport":true},"formatting":{"dynamicRegistration":false},"rangeFormatting":{"dynamicRegistration":false},"rename":{"dynamicRegistration":false},"inlayHint":{"dynamicRegistration":false},"publishDiagnostics":{"relatedInformation":false,"codeDescriptionSupport":false,"tagSupport":{"valueSet":[1,2]}}},"window":{"showDocument":{"support":true},"workDoneProgress":true},"general":{"positionEncodings":["utf-32","utf-8","utf-16"]},"experimental":{}},"workspaceFolders":[{"uri":"file:///home/davidaventimiglia/Scratch/eglot-problem-description","name":"~/Scratch/eglot-problem-description/"}]}}
   [jsonrpc] e[05:56:11.611] <-- initialize[1] {"id":1,"jsonrpc":"2.0","result":{"capabilities":{"callHierarchyProvider":true,"codeActionProvider":{"codeActionKinds":["source","source.organizeImports","source.fixAll","source.sortMembers","quickfix","refactor"]},"codeLensProvider":{},"colorProvider":{"documentSelector":[{"language":"dart","scheme":"file"}]},"completionProvider":{"completionItem":{"labelDetailsSupport":true},"resolveProvider":true,"triggerCharacters":[".","=","(","$","\"","'","{","/",":"]},"definitionProvider":true,"documentFormattingProvider":true,"documentHighlightProvider":true,"documentLinkProvider":{"resolveProvider":false},"documentOnTypeFormattingProvider":{"firstTriggerCharacter":"}","moreTriggerCharacter":[";"]},"documentRangeFormattingProvider":true,"documentSymbolProvider":true,"executeCommandProvider":{"commands":["dart.edit.sortMembers","dart.edit.organizeImports","dart.edit.fixAll","dart.edit.fixAllInWorkspace.preview","dart.edit.fixAllInWorkspace","dart.edit.sendWorkspaceEdit","refactor.perform","refactor.validate","dart.logAction","dart.refactor.convert_all_formal_parameters_to_named","dart.refactor.convert_selected_formal_parameters_to_named","dart.refactor.move_selected_formal_parameters_left","dart.refactor.move_top_level_to_file"],"workDoneProgress":true},"experimental":{"textDocument":{"super":{},"augmented":{},"augmentation":{}}},"foldingRangeProvider":true,"hoverProvider":true,"implementationProvider":true,"inlayHintProvider":{"resolveProvider":false},"referencesProvider":true,"renameProvider":true,"selectionRangeProvider":true,"semanticTokensProvider":{"full":{"delta":false},"legend":{"tokenModifiers":["documentation","constructor","declaration","importPrefix","instance","static","escape","annotation","control","label","interpolation","void"],"tokenTypes":["annotation","keyword","class","comment","method","variable","parameter","enum","enumMember","type","source","property","namespace","boolean","number","string","function","typeParameter"]},"range":true},"signatureHelpProvider":{"retriggerCharacters":[","],"triggerCharacters":["("]},"textDocumentSync":{"change":2,"openClose":true,"willSave":false,"willSaveWaitUntil":false},"typeDefinitionProvider":true,"typeHierarchyProvider":true,"workspace":{"fileOperations":{"willRename":{"filters":[{"pattern":{"glob":"**/*.dart","matches":"file"},"scheme":"file"},{"pattern":{"glob":"**/","matches":"folder"},"scheme":"file"}]}},"workspaceFolders":{"changeNotifications":true,"supported":true}},"workspaceSymbolProvider":true},"serverInfo":{"name":"Dart SDK LSP Analysis Server","version":"3.4.4"}}}
   [jsonrpc] e[05:56:11.611] --> initialized {"jsonrpc":"2.0","method":"initialized","params":{}}
   [jsonrpc] e[05:56:11.612] --> textDocument/didOpen {"jsonrpc":"2.0","method":"textDocument/didOpen","params":{"textDocument":{"uri":"file:///home/davidaventimiglia/Scratch/eglot-problem-description/main.dart","version":0,"languageId":"dart","text":"void main() {\n  print(\"Hello, World!\");\n}\n"}}}
   [jsonrpc] e[05:56:11.612] --> workspace/didChangeConfiguration {"jsonrpc":"2.0","method":"workspace/didChangeConfiguration","params":{"settings":{}}}
   [jsonrpc] e[05:56:11.636] --> textDocument/inlayHint[2] {"jsonrpc":"2.0","id":2,"method":"textDocument/inlayHint","params":{"textDocument":{"uri":"file:///home/davidaventimiglia/Scratch/eglot-problem-description/main.dart"},"range":{"start":{"line":0,"character":0},"end":{"line":3,"character":0}}}}
   [jsonrpc] e[05:56:11.663] <-- workspace/configuration[1] {"id":1,"jsonrpc":"2.0","method":"workspace/configuration","params":{"items":[{"scopeUri":"file:///home/davidaventimiglia/Scratch/eglot-problem-description","section":"dart"},{"section":"dart"}]}}
   [jsonrpc] e[05:56:11.664] --> workspace/configuration[1] {"jsonrpc":"2.0","id":1,"result":[null,null]}
   [jsonrpc] e[05:56:11.664] <-- window/workDoneProgress/create[2] {"id":2,"jsonrpc":"2.0","method":"window/workDoneProgress/create","params":{"token":"ANALYZING"}}
   [jsonrpc] e[05:56:11.664] --> window/workDoneProgress/create[2] {"jsonrpc":"2.0","id":2,"result":null}
   [jsonrpc] e[05:56:11.664] <-- workspace/configuration[3] {"id":3,"jsonrpc":"2.0","method":"workspace/configuration","params":{"items":[{"scopeUri":"file:///home/davidaventimiglia/Scratch/eglot-problem-description","section":"dart"},{"section":"dart"}]}}
   [jsonrpc] e[05:56:11.664] --> workspace/configuration[3] {"jsonrpc":"2.0","id":3,"result":[null,null]}
   [jsonrpc] e[05:56:12.137] --> textDocument/hover[3] {"jsonrpc":"2.0","id":3,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/davidaventimiglia/Scratch/eglot-problem-description/main.dart"},"position":{"line":0,"character":0}}}
   [jsonrpc] e[05:56:12.138] --> textDocument/documentHighlight[4] {"jsonrpc":"2.0","id":4,"method":"textDocument/documentHighlight","params":{"textDocument":{"uri":"file:///home/davidaventimiglia/Scratch/eglot-problem-description/main.dart"},"position":{"line":0,"character":0}}}
   [jsonrpc] e[05:56:12.138] --> textDocument/signatureHelp[5] {"jsonrpc":"2.0","id":5,"method":"textDocument/signatureHelp","params":{"textDocument":{"uri":"file:///home/davidaventimiglia/Scratch/eglot-problem-description/main.dart"},"position":{"line":0,"character":0}}}
   [jsonrpc] i[05:56:21.637] [2] timed-out request ':textDocument/inlayHint'
   [jsonrpc] i[05:56:22.138] [3] timed-out request ':textDocument/hover'
   [jsonrpc] i[05:56:22.138] [4] timed-out request ':textDocument/documentHighlight'
   [jsonrpc] i[05:56:22.144] [5] timed-out request ':textDocument/signatureHelp'
   #+end_src

2. If Emacs signaled an error (an error message was seen or heard),
   make sure to repeat the process after turning on debug-on-error via
   M-x toggle-debug-on-error. This normally produces a backtrace of
   the error that should also be attached to the bug report.

   - Answer :: Emacs does not signal an error.

3. Include a description of how the maintainer should obtain, install,
   and configure the language server you used. Maintainers usually
   have access to GNU/Linux systems, though not necessarily the
   distribution that you may be using. If possible, try to replicate
   the problem with the C/C++ or Python servers, as these are very
   easy to install.

   - Answer :: Follow the instructions to [[https://dart.dev/get-dart#install][Install the Dart SDK]] for your OS.

4. Describe how to setup a minimal project directory where Eglot
   should be started for the problem to happen. Describe each file’s
   name and its contents. Alternatively, you can supply the address of
   a public Git repository.

   - Answer :: A minimal project directory is in this GitHub repository [[https://github.com/dventimiglia/eglot-problem-description][here]].

5. Include versions of the software used. The Emacs version can be
   obtained with M-x emacs-version. We welcome bug reports about all
   Eglot versions, but it is helpful to first check if the problem
   isn’t already fixed in the latest version (see Getting the latest
   version). It’s also essential to include the version of ELPA
   packages that are explicitly or implicitly loaded. The optional but
   popular Company or Markdown packages are distributed as GNU ELPA
   packages, not to mention Eglot itself in some situations. Some
   major modes (Go, Rust, etc.) are provided by ELPA packages. It’s
   sometimes easy to miss these, since they are usually implicitly
   loaded when visiting a file in that language. ELPA packages usually
   live in ~/.emacs.d/elpa (or what is in package-user-dir). Including
   a listing of files in that directory is a way to tell the
   maintainers about ELPA package versions.

   - Answer :: dart-mode Version: 1.0.7; emacs Version: see below

   #+begin_src elisp
     (emacs-version)
   #+end_src

   #+RESULTS:
   : GNU Emacs 29.4 (build 2, x86_64-pc-linux-gnu, GTK+ Version 3.24.20, cairo version 1.16.0)
   :  of 2024-06-23

6. Include a recipe to replicate the problem with a clean Emacs
   run. The invocation emacs -Q -f package-initialize starts Emacs
   with no configuration and initializes the ELPA packages. A very
   minimal .emacs initialization file (10 lines or less) is also
   acceptable and good means to describe changes to variables. There
   is usually no need to include require statements in the recipe, as
   Eglot’s functionality uses autoloads. Likewise, there is rarely the
   need to use things like use-package or eglot-ensure. This just
   makes the recipe harder to follow. Prefer setting variables with
   setq and adding to hooks with add-hook. Prefer starting Eglot with
   M-x eglot.

   - Answer :: see below

   1. Download this repository.

7. Make sure to double check all the above elements and re-run the
   recipe to see that the problem is reproducible. Following the
   recipe should produce event transcript and error backtraces that
   are very similar to the ones you included. If the problem only
   happens sometimes, mention this in your report.


